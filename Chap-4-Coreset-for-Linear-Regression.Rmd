# Coresets for Linear Regression

We will see one of the methods to select coreset points for linear regression. We calculate "Ridge leverage scores" to  create a sampling distribution for coreset selection. The process to calculate sampling distribution $p(X)$ is as the following.

1. $X_* = \begin{bmatrix}X \\ \lambda I_d\end{bmatrix}$
2. $U \Sigma V^T = X_*$
3. $\mathbf{p}(X) = ||U(0:n, :)||_2^2$

Now, let us implement this in a python function.

```{python}
def get_proba(x, lmd):
    x_list = [np.ones(x.shape[0]), x.ravel()]
    x_extra = np.vstack(x_list).T
    A = np.vstack([x_extra, np.eye(x_extra.shape[1])*np.sqrt(lmd)])
    U, S, V = np.linalg.svd(A, full_matrices=False)
    U1 = U[:x.shape[0], :]
    proba = np.square(U1).sum(axis=1)/np.square(U1).sum(axis=1).sum()
    return proba
```

We will sample the coresets for 

`r if (knitr::is_html_output()) '# References {-}'`